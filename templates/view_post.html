{% extends "template.html" %}

{% block content %}
	{% if user_id and user_id == post.author_id %}

	<h2>{{ post.title }}</h2>
	<em>by {{ author }}</em>
	<p>{{ post.content | safe }}</p>
	<a href="/like?post_id={{ post_id }}&source={{ post_id }}">
		{% if was_liked:%}
			Liked&nbsp;
		{% else: %}
			Like&nbsp;
		{% endif %}
		<span>{{ like_counter }}</span>
	</a>
	<br>
	<a href="/editpost?post_id={{ post_id }}">Edit</a>
	<a href="/deletepost?post_id={{ post_id }}">Delete</a>
	{% endif %}
	<hr>
	<section class="new_comment">
		{% if user_id: %}
		<form method="post">
			<label>Leave your comment</label>
			<br>
			<textarea name="content">{{ content }}</textarea>
			<input type="submit">
		</form>
		{% else: %}
		<p>You must be <a href="/signup">signed in</a> to comment</p>
		{% endif %}
		<div class="error">{{ error }}</div>
	</section>
	<hr>
	<section class="comments">
		{% for entry in comments: %}
		<div>
			<em><strong>{{ entry.author }}</strong></em>
			<em>{{ entry.comment.created|datetimeformat }}</em>
			<p>{{ entry.comment.content }}</p>
			{% if user_id and user_id == entry.comment.user_id: %}
			<a href="/editcomment?comment_id={{ entry.comment_id }}">Edit</a>
			<a href="/deletecomment?comment_id={{ entry.comment_id }}">Delete</a>
			{% endif %}
		</div>
		<hr>
		{% endfor %}
	</section>
{% endblock %}