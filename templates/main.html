{% extends "template.html" %}

{% block content %}
    {% for entry in posts %}
        <div>
            <h2><a href="/{{ entry.post.id }}">{{ entry.post.title }}</a></h2>
            <div class="author">
                <em><strong>by {{ entry.post.author }}</strong></em>
            </div>
            <p>{{ entry.post.content | formattext | safe }}</p>
            <div class="social">
                {% if user_id == entry.post.author_id: %}
                    <a href="#" data-toggle="tooltip" title="You can't like your own post">
                        <span class="glyphicon glyphicon-heart-empty" aria-hidden="true"></span>
                        <span>{{ entry.post.likes | length }}</span>
                    </a>
                {% else: %}
                    <a href="/like?post_id={{ entry.post.id }}&source=">
                    {% if user_id in entry.post.users_liked:%}
                        <span class="glyphicon glyphicon-heart" aria-hidden="true"></span>
                    {% else: %}
                        <span class="glyphicon glyphicon-heart-empty" aria-hidden="true"></span>
                    {% endif %}
                    <span>{{ entry.post.likes | length }}</span>
                    </a>
                {% endif %}
                <a href="/{{ entry.post.id }}">{{ entry.post.comments | length }} comments</a>
            </div>
            {% if user_id == entry.post.author_id: %}
            <div class="change-panel">
                <a href="/editpost?post_id={{ entry.post.id }}">Edit</a>
                <a href="/deletepost?post_id={{ entry.post.id }}">Delete</a>
            </div>
            {% endif %}

        </div>
        <hr>
    {% endfor %}
{% endblock %}